function isMobile(){var a=!1;return function(b){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(b)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(b.substr(0,4)))&&(a=!0)}(navigator.userAgent||navigator.vendor||window.opera),a}function CommentLoader(a,b,c){null==c&&(c=function(){});var d=null;d=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),d.open("GET",a,!0),d.send();var e=b;d.onreadystatechange=function(){if(4==d.readyState&&200==d.status)if("Microsoft Internet Explorer"==navigator.appName){var a=new ActiveXObject("Microsoft.XMLDOM");a.async=!1,a.loadXML(d.responseText),e.load(BilibiliParser(a)),c()}else e.load(BilibiliParser(d.responseXML)),c()}}function createCORSRequest(a,b){var c=new XMLHttpRequest;return"withCredentials"in c?c.open(a,b,!0):"undefined"!=typeof XDomainRequest?(c=new XDomainRequest,c.open(a,b)):c=null,c}var ABP={version:"0.8.0.1-sMod_bili"};!function(){"use strict";if(ABP){var a=function(a,c,d,e){var f=null;if("text"===a)return document.createTextNode(c);f=document.createElement(a);for(var g in c)if("style"===g)for(var h in c.style)f.style[h]=c.style[h];else"className"===g?f.className=c[g]:"html"===g?f.innerHTML=c[g]:"tooltip"===g?(f.tooltip=c[g],b(f.tooltip,"ABP-Tooltip"),f.addEventListener("mouseover",function(a){document.body.appendChild(f.tooltip);var b=document.documentElement.getBoundingClientRect(),c=f.getBoundingClientRect(),d=f.tooltip.getBoundingClientRect();c.bottom+5+d.height<document.documentElement.clientHeight?(f.tooltip.style.left=c.left-b.left+c.width/2-d.width/2+"px",f.tooltip.style.top=c.bottom-b.top+2+"px"):(f.tooltip.style.left=c.left-b.left+c.width+2+"px",f.tooltip.style.top=c.top-b.top+c.height/2-d.height/2+"px");var d=f.tooltip.getBoundingClientRect();d.right>document.documentElement.clientWidth?f.tooltip.style.left=c.left-b.left-d.width-2+"px":d.left<0&&(f.tooltip.style.left=c.left-b.left+c.width+2+"px"),"undefined"!=typeof f.updatetooltip&&f.updatetooltip&&f.updatetooltip(a)}),f.addEventListener("mousemove",function(a){"undefined"!=typeof f.updatetooltip&&f.updatetooltip&&f.updatetooltip(a)}),f.addEventListener("mouseout",function(){document.body.removeChild(f.tooltip)})):"updatetooltip"===g?f.updatetooltip=c[g]:f.setAttribute(g,c[g]);if(d)for(var i=0;i<d.length;i++)null!=d[i]&&f.appendChild(d[i]);return e&&"function"==typeof e&&e(f),f},b=function(a,b){if(null!=a){var c=a.className.split(" ");c.indexOf(b)<0&&c.push(b),a.className=c.join(" ")}},c=function(a,b){if(null==a)return!1;var c=a.className.split(" ");return c.indexOf(b)>=0},d=function(a,b){if(null!=a){var c=a.className.split(" ");c.indexOf(b)>=0&&c.splice(c.indexOf(b),1),a.className=c.join(" ")}},e=function(a,b){var c={};for(var d in b)c[d]=a&&"undefined"!=typeof a[d]?a[d]:b[d];return c},f=function(a){var b=document.createEvent("HTMLEvents");return b.initEvent(a,!1,!1),b},g=function(b,c){var d,e=a("div",{className:"dark"}),g=a("div",{className:"load"});d="undefined"!=typeof c?a("div",{className:"bar",tooltip:a("div",{}),updatetooltip:c},[g,e]):a("div",{className:"bar"},[g,e]),b.appendChild(d),b.bar=d;var h,i;b.progress={get main(){return h},set main(a){"number"!=typeof a||0>a||a>100||(h=a,e.style.width=a+"%")},get secondary(){return i},set secondary(a){"number"!=typeof a||0>a||a>100||(i=a,g.style.width=a+"%")}},b.progress.main=0,b.progress.secondary=0,b.dragging=!1;var j;return d.addEventListener("mousedown",function(a){b.dragging=!0;var c=a.clientX-this.getBoundingClientRect().left;c>=0&&c<=this.offsetWidth&&(j=100*c/this.offsetWidth),b.progress.main=j,b.dispatchEvent(new Event("startdrag"))}),document.addEventListener("mouseup",function(){b.dragging&&(b.dragging=!1,b.dispatchEvent(new Event("stopdrag")))}),d.addEventListener("mouseup",function(a){b.dragging=!1;var c=a.clientX-this.getBoundingClientRect().left;c>=0&&c<=this.offsetWidth&&(j=100*c/this.offsetWidth),b.progress.main=j,b.dispatchEvent(new Event("stopdrag"))}),d.addEventListener("mousemove",function(a){if(b.dragging){var c=a.clientX-this.getBoundingClientRect().left;c>=0&&c<=this.offsetWidth&&(j=100*c/this.offsetWidth,b.progress.main=j,b.dispatchEvent(f("ondrag")))}}),b},h=function(a){var b=parseInt(a),c=parseInt(b/60);return b%=60,c+":"+(10>b?"0":"")+b},i=function(a,b){for(var c=a.toString().length;b>c;)a="0"+a,c++;return a},j=function(b){var c=new Date(1e3*b.date);return a("div",{className:"ABP-CommentList-Item"},[a("div",{className:"time",html:h(parseInt(b.stime/1e3))}),a("div",{className:"content",html:b.text,tooltip:a("div",{html:b.text})}),a("div",{className:"date",html:c.getMonth()+1+"-"+c.getDate()+" "+c.getHours()+":"+i(c.getMinutes(),2),tooltip:a("div",{html:c.getFullYear()+"-"+(c.getMonth()+1)+"-"+c.getDate()+" "+c.getHours()+":"+i(c.getMinutes(),2)+":"+i(c.getSeconds(),2)})})])};ABP.create=function(b,d){var f=b;d||(d={}),d=e(d,{replaceMode:!0,width:1280,height:640,src:"",mobile:!1}),"string"==typeof b&&(f=document.getElementById(b)),f.children.length>0&&d.replaceMode&&(f.innerHTML="");var g;c(f,"ABP-Unit")?g=f:(g=a("div",{className:"ABP-Unit",style:{width:d.width+"px",height:d.height+"px"}}),f.appendChild(g));var h=[];if("string"==typeof d.src)d.src=a("video",{className:"ABP-VideoItem",preload:"meatdata"},[a("source",{src:d.src})]),h.push(d.src);else if(d.src.hasOwnProperty("playlist"))for(var i=d.src,k=i.playlist,l=0;l<k.length;l++)if(k[l].hasOwnProperty("sources")){var m=[];for(var n in k[l].sources)m.push(a("source",{src:k[l].sources[n],type:n}));h.push(a("video",{className:0==l?"ABP-VideoItem":"ABP-VideoItem ABP-VideoItemHidden",preload:"metadata"},m))}else k[l].hasOwnProperty("video")?h.push(k[l].video):console.log("No recognized format");else h.push(d.src);for(var o=[],p=0;p<h.length;p++)o.push(h[p]);o.push(a("div",{className:"ABP-Container"})),g.appendChild(a("div",{className:"ABP-Player"},[a("div",{className:"ABP-Video",tabindex:"10"},o),a("div",{className:"ABP-Toolbar"},[a("div",{className:"ABP-Text"},[a("div",{className:"button ABP-CommentFont",tooltip:a("div",{html:"弹幕大小与弹幕模式（未实现）"})}),a("div",{className:"button ABP-CommentColor",tooltip:a("div",{html:"弹幕颜色（未实现）"})}),a("div",{className:"button right ABP-CommentSend",tooltip:a("div",{html:"毁灭地喷射白光！da！"}),html:"发送 >"}),a("div",{className:"ABP-TextBox autofill"},[a("input",{type:"text"})])]),a("div",{className:"ABP-Control"},[a("div",{className:"button ABP-Play",tooltip:a("div",{html:"播放/暂停"})}),a("div",{className:"button right ABP-FullScreen",tooltip:a("div",{html:"全屏播放"})}),a("div",{className:"button right ABP-FullWindow",tooltip:a("div",{html:"网页全屏"})}),a("div",{className:"button right ABP-WideScreen",tooltip:a("div",{html:"宽屏"})}),a("div",{className:"button right ABP-Loop",tooltip:a("div",{html:"洗脑循环"})}),a("div",{className:"button right ABP-CommentShow",tooltip:a("div",{html:"弹幕开关"})}),a("div",{className:"ABP-Opacity"},[a("div",{html:"透明度"}),a("div",{className:"opacity-bar"})]),a("div",{className:"volume-bar right",tooltip:a("div",{html:"音量调节"})}),a("div",{className:"button right ABP-VolumeButton",tooltip:a("div",{html:"静音"})}),a("div",{className:"right ABP-TimeLabel"}),a("div",{className:"progress-bar autofill"})])]),a("div",{className:"box ABP-CommentFont-Box"}),a("div",{className:"box ABP-CommentColor-Box"})])),g.appendChild(a("div",{className:"ABP-CommentList ABP-SideBlock"},[a("div",{className:"ABP-CommentList-Title"},[a("div",{className:"time",html:"时间"}),a("div",{className:"content",html:"评论"}),a("div",{className:"date",html:"发送日期"})]),a("div",{className:"ABP-CommentList-Container"})])),g.appendChild(a("div",{className:"ABP-InfoBox ABP-SideBlock"},[])),g.appendChild(a("div",{className:"ABP-Settings ABP-SideBlock"},[]));var q=ABP.bind(g,d.mobile);return d.src.hasOwnProperty("danmaku")&&(q.cmManager.timeline=[],CommentLoader(d.src.danmaku,q.cmManager,function(){for(var a=0;a<q.cmManager.timeline.length;a++)q.cmList.appendChild(j(q.cmManager.timeline[a]))})),"undefined"!=typeof ABP_Restyle&&ABP_Restyle(),q},ABP.bind=function(a,c,i){function k(a){d(s.videos[a],"ABP-VideoItemHidden");for(var c=0;c<s.videos.length;c++)c!=a&&b(s.videos[c],"ABP-VideoItemHidden");s.currentItem=a}function l(a){s.videos[s.currentItem].pause();for(var b=0;b<s.videos.length&&a>s.videos[b].duration;)a-=s.videos[b].duration,b++;b>=s.videos.length||(s.videos[b].currentTime=a,k(b),s.cmManager&&(s.cmManager.time(parseInt(1e3*a)),s.cmManager.clear()),s.playing&&(s.cmManager&&s.state.danmaku&&s.cmManager.startTimer(),s.videos[s.currentItem].play()))}function m(){return{mode:1,stime:parseInt(1e3*s.currentTime),text:s.txtText.value,size:25,color:16777215,date:parseInt((new Date).valueOf()/1e3)}}var n=0,o=!1,p=!1,q=[],r=100,s={btnPlay:null,divComment:null,btnFullScr:null,btnFullWin:null,btnWide:null,btnDm:null,btnLoop:null,videos:null,timeLabel:null,divTextField:null,txtText:null,cmManager:null,cmList:null,currentItem:0,duration:0,buffered:0,defaults:{w:0,h:0},state:e(i,{widescreen:!1,fullwindow:!1,fullscreen:!1,allowRescale:!1,autosize:!1,loop:!1,danmaku:!0,mute:!1}),resetLayout:null,wideScreen:null,fullWindow:null,ready:!1,play:null,pause:null,playing:!1,get currentTime(){return n},set currentTime(a){l(a)},addListener:null,dispatch:null,disableTime:15},t=function(a){return 100*a/s.duration};s.addListener=function(a,b){return"string"!=typeof a?void console.err(a+" is not a event name"):"function"!=typeof b?void console.err(b+" is not a listener"):("undefined"==typeof q[a]&&(q[a]=[]),void q[a].push(b))},s.dispatch=function(a,b){if("undefined"!=typeof q[a])for(var c=0;c<q[a].length;c++)"undefined"!=typeof b?q[a][c](b):q[a][c]()},s.resetLayout=function(){if(s.state.widescreen=!1,s.state.fullwindow=!1,s.state.fullscreen=!1,window.outerHeight==screen.height&&window.outerWidth==screen.width){var b=document,c=b.cancelFullScreen||b.webkitCancelFullScreen||b.mozCancelFullScreen||b.exitFullScreen;if("undefined"!=typeof c&&c)c.call(b);else if("undefined"!=typeof window.ActiveXObject){var e=new ActiveXObject("WScript.Shell");null!=e&&e.SendKeys("{F11}")}}d(a,"ABP-Wide"),d(a,"ABP-Full"),d(a,"ABP-Screen"),d(document.getElementsByTagName("body")[0],"ABP-NoScroll"),s.cmManager&&s.cmManager.setBounds()},s.wideScreen=function(){s.resetLayout(),b(a,"ABP-Wide"),s.state.widescreen=!0,s.cmManager&&s.cmManager.setBounds()},s.fullWindow=function(){s.resetLayout(),b(a,"ABP-Full"),b(document.getElementsByTagName("body")[0],"ABP-NoScroll"),s.state.fullwindow=!0,s.cmManager&&s.cmManager.setBounds()},s.fullScreen=function(){s.fullWindow();var c=document.documentElement,d=c.requestFullScreen||c.webkitRequestFullScreen||c.mozRequestFullScreen||c.msRequestFullScreen;if("undefined"!=typeof d&&d)d.call(c);else if("undefined"!=typeof window.ActiveXObject){var e=new ActiveXObject("WScript.Shell");null!=e&&e.SendKeys("{F11}")}b(a,"ABP-Screen"),s.cmManager&&s.cmManager.setBounds(),setTimeout(function(){s.state.fullscreen=!0},100)},s.play=function(){s.playing||(s.videos[s.currentItem].play(),s.cmManager&&s.state.danmaku&&s.cmManager.startTimer(),s.playing=!0,s.dispatch("play"))},s.pause=function(){s.playing&&(s.videos[s.currentItem].pause(),s.cmManager&&s.cmManager.stop(),s.playing=!1,s.dispatch("pause"))},s.setLoop=function(a){a?(s.state.loop=!0,b(s.btnLoop,"ABP-LoopOn")):(s.state.loop=!1,d(s.btnLoop,"ABP-LoopOn"))},s.setDanmaku=function(a){a?(s.cmManager.time(parseInt(1e3*s.currentTime)),s.cmManager.clear(),s.cmManager.startTimer(),d(s.btnDm,"ABP-DanmakuOff")):(s.cmManager.stopTimer(),s.cmManager.clear(),b(s.btnDm,"ABP-DanmakuOff")),s.state.danmaku=a},s.mute=function(a){a!=s.state.mute&&(s.state.mute=a,a?(r=s.barVolume.progress.main,s.barVolume.progress.main=0,b(s.btnVolume,"muted")):(s.barVolume.progress.main=r,d(s.btnVolume,"muted")))},s.videos=a.getElementsByClassName("ABP-VideoItem"),s.btnPlay=a.getElementsByClassName("ABP-Play")[0],s.barProgress=g(a.getElementsByClassName("progress-bar")[0],null),s.btnFullWin=a.getElementsByClassName("ABP-FullWindow")[0],s.btnFullScr=a.getElementsByClassName("ABP-FullScreen")[0],s.btnWide=a.getElementsByClassName("ABP-WideScreen")[0],s.btnLoop=a.getElementsByClassName("ABP-Loop")[0],s.btnVolume=a.getElementsByClassName("ABP-VolumeButton")[0],s.barVolume=g(a.getElementsByClassName("volume-bar")[0]),s.barOpacity=g(a.getElementsByClassName("opacity-bar")[0],null),s.divTextField=a.getElementsByClassName("ABP-Text")[0],s.txtText=s.divTextField.getElementsByTagName("input")[0],s.btnDm=a.getElementsByClassName("ABP-CommentShow")[0],s.divComment=a.getElementsByClassName("ABP-Container")[0],s.timeLabel=a.getElementsByClassName("ABP-TimeLabel")[0],s.btnSend=a.getElementsByClassName("ABP-CommentSend")[0],s.videoarea=a.getElementsByClassName("ABP-Video")[0],s.cmList=a.getElementsByClassName("ABP-CommentList-Container")[0],s.defaults.w=s.divComment.offsetWidth,s.defaults.h=s.divComment.offsetHeight,"undefined"!=typeof CommentManager&&(s.cmManager=new CommentManager(s.divComment),s.cmManager.init(),s.cmManager.clear()),s.timeLabel.setTime=function(a){this.innerHTML=h(a)+"/"+h(s.duration)},window.addEventListener("resize",function(){!s.state.fullscreen||window.outerHeight==screen.height&&window.outerWidth==screen.width||s.resetLayout()});for(var u=0;u<s.videos.length;u++){var v=s.videos[u],w=0;v.itemNo=u,v.buffComplete=!1,v.addEventListener("loadedmetadata",function(){s.duration+=s.videos[this.itemNo].duration,w++,w==s.videos.length&&(s.ready=!0,console.log("ABP duration "+s.duration),s.timeLabel.setTime(0),s.videos[0].play(),s.videos[0].pause(),s.dispatch("ready")),s.videos[0].dispatchEvent(f("progress"))});v.addEventListener("progress",function(){var a,b,c=0;for(b=0;b<s.currentItem;b++)a+=s.videos[b].duration;for(;b<s.videos.length;b++){try{a=s.videos[b].buffered.end(0)}catch(d){break}if(c+=a,a<s.videos[b].duration)break}s.buffered=c,s.dispatch("progress"),s.buffered==s.duration?s.dispatch("buffered"):this.buffered.length>0&&this.buffered.end(0)==this.duration&&this.itemNo+1!=s.currentItem&&this.itemNo+1<s.videos.length&&(s.videos[this.itemNo+1].play(),s.videos[this.itemNo+1].pause())}),v.addEventListener("timeupdate",function(){if(this.itemNo==s.currentItem){p&&s.cmManager&&s.state.danmaku&&s.cmManager.startTimer(),p=!1;for(var a=this.currentTime,b=0;b<this.itemNo;b++)a+=s.videos[b].duration;n=a,o||(s.timeLabel.setTime(a),s.barProgress.progress.main=t(a)),s.cmManager.time(parseInt(1e3*a))}}),v.addEventListener("waitting",function(){this.itemNo==s.currentItem&&(!p&&s.cmManager&&s.cmManager.stopTimer(),p=!0)}),v.addEventListener("ended",function(){this.itemNo==s.currentItem&&(this.itemNo<s.videos.length-1?(k(this.itemNo+1),s.videos[this.itemNo+1].currentTime=0,s.videos[this.itemNo+1].play()):s.state.loop?l(0):(s.playing=!1,s.dispatch("stop")))})}if(s.btnFullScr.addEventListener("click",function(){s.state.fullscreen?s.resetLayout():s.fullScreen()}),s.btnFullWin.addEventListener("click",function(){!s.state.fullwindow||s.state.fullscreen?s.fullWindow():s.resetLayout()}),s.btnWide.addEventListener("click",function(){s.state.widescreen?s.resetLayout():s.wideScreen()}),s.btnDm.addEventListener("click",function(){s.setDanmaku(!s.state.danmaku)}),s.btnLoop.addEventListener("click",function(){s.setLoop(!s.state.loop)}),s.btnPlay.addEventListener("click",function(){s.playing?s.pause():s.play()}),s.videoarea.addEventListener("click",function(){s.playing?s.pause():s.play()}),s.barProgress.addEventListener("stopdrag",function(){o=!1,l(this.progress.main/100*s.duration)}),s.barProgress.addEventListener("ondrag",function(){o=!0,s.timeLabel.setTime(this.progress.main/100*s.duration)}),s.barProgress.bar.updatetooltip=function(a){var b=a.clientX-this.getBoundingClientRect().left;b>=0&&b<=this.offsetWidth&&(this.tooltip.innerHTML=h(b*s.duration/this.offsetWidth));var c=document.body.getBoundingClientRect(),d=this.getBoundingClientRect(),e=this.tooltip.getBoundingClientRect();this.tooltip.style.left=b+d.left-c.left-e.width/2+"px",this.tooltip.style.top=d.top-c.top-e.height+2+"px"},s.btnVolume.addEventListener("click",function(){s.mute(!s.state.mute)}),s.barVolume.progress.main=100,s.barVolume.addEventListener("stopdrag",function(){for(var a=0;a<s.videos.length;a++)s.videos[a].volume=s.barVolume.progress.main/100}),s.barVolume.addEventListener("ondrag",function(){for(var a=0;a<s.videos.length;a++)s.videos[a].volume=s.barVolume.progress.main/100}),s.barVolume.addEventListener("startdrag",function(){s.mute(!1)}),s.barOpacity.progress.main=100,s.barOpacity.addEventListener("stopdrag",function(){s.cmManager.options.global.opacity=s.barOpacity.progress.main/100}),s.barOpacity.addEventListener("ondrag",function(){s.cmManager.options.global.opacity=s.barOpacity.progress.main/100}),s.barOpacity.bar.updatetooltip=function(a){var b=a.clientX-this.getBoundingClientRect().left;b>=0&&b<=this.offsetWidth&&(this.tooltip.innerHTML=parseInt(b/this.offsetWidth*100)/100);var c=document.body.getBoundingClientRect(),d=this.getBoundingClientRect(),e=this.tooltip.getBoundingClientRect();this.tooltip.style.left=b+d.left-c.left-e.width/2+"px"},s.addListener("play",function(){s.cmManager.setBounds(),b(s.btnPlay,"ABP-Playing")}),s.addListener("pause",function(){d(s.btnPlay,"ABP-Playing")}),s.addListener("stop",function(){d(s.btnPlay,"ABP-Playing")}),s.addListener("progress",function(){s.barProgress.progress.secondary=t(s.buffered)}),s.dminsert=function(a){s.cmManager.insert(a),s.cmList.appendChild(j(a))},s.dmsend=function(a){s.cmManager.send(a)},s.btnSend.addEventListener("click",function(){s.dispatch("senddanmaku",m())}),s.txtText.addEventListener("keydown",function(a){a&&13==a.keyCode&&s.dispatch("senddanmaku",m())}),s.addListener("senddanmaku",function(a){console.log("send danmaku: "+a),s.txtText.value="发射器冷却中......",s.txtText.setAttribute("disabled","disabled"),setTimeout(function(){s.txtText.value="",s.txtText.removeAttribute("disabled")},1e3*s.disableTime)}),a.addEventListener("keydown",function(a){a&&32==a.keyCode&&document.activeElement!==s.txtText&&(s.btnPlay.click(),a.preventDefault())}),"undefined"!=typeof CommentManager&&s.state.autosize){var x=function(){if(0!==video.videoHeight&&0!==video.videoWidth){var b=video.videoHeight/video.videoWidth,c=a.offsetWidth,d=a.offsetHeight,e=d/c;b>e?(a.style.width=d/b+"px",a.style.height=d+"px"):(a.style.width=c+"px",a.style.height=c*b+"px"),s.cmManager.setBounds()}};video.addEventListener("loadedmetadata",x),x()}return s}}}();